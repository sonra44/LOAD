# СПИСОК ФАЙЛОВ
- /home/sonra44/QIKI_DTMP/services/q_core_agent/config/ship_config.json

## Вход и цель
- [Факт] Проанализировать расширенную конфигурацию корабля.
- [Факт] Итог: выделить структуру, риски и рекомендации.

## Сбор контекста
- [Факт] JSON описывает корабль: `schema_version`, `ship_id`, `ship_class`, `mode`.
- [Факт] Включает секции `hull`, `power_systems`, `propulsion`, `sensors`, `life_support`, `computing`.
- [Гипотеза] Используется симулятором или ИИ-ядром для моделирования состояния корабля.

## Локализация артефакта
- [Факт] Путь: `/home/sonra44/QIKI_DTMP/services/q_core_agent/config/ship_config.json`.
- [Факт] JSON ~160 строк, вложенная структура словарей и массивов.

## Фактический разбор
- [Факт] `hull` содержит метрики целостности и характеристики отсеков.
- [Факт] `power_systems` описывает реактор, батареи и распределение энергии.
- [Факт] `propulsion` задаёт главный двигатель и RCS-двигатели.
- [Факт] `sensors` перечисляет датчики с параметрами диапазона и потребления.
- [Факт] `life_support` включает атмосферу, воду и воздух.
- [Факт] `computing` содержит основной AI-процессор и резервные компьютеры.
- [Гипотеза] Отсутствует информация о вооружении или щитах, возможно хранится отдельно.

## Роль в системе и связи
- [Факт] Конфигурация задаёт исходные данные для систем управления и мониторинга.
- [Гипотеза] Может синхронизироваться с `bot_config.json` для роботизированных систем.

## Несоответствия и риски
- [Факт] Нет явного указания единиц для некоторых полей (например, `volume`). — Приоритет: Med.
- [Факт] `mode` фиксирован на `full`, нет вариантов. — Приоритет: Low.
- [Гипотеза] При росте файла сложность поддержки увеличится. — Приоритет: Med.
- [Гипотеза] Отсутствие проверки целостности секций. — Приоритет: High.

## Мини-патчи (safe-fix)
- [Патч] Добавить поле `units` в числовые блоки.
- [Патч] Ввести версионирование для каждой секции отдельно.
- [Патч] Разбить файл на несколько модулей по подсистемам.

## Рефактор-скетч (по желанию)
```python
import json
from dataclasses import dataclass

@dataclass
class Reactor:
    id: str
    max_output_mw: float

@dataclass
class ShipConfig:
    ship_id: str
    reactor: Reactor

def load(path: str) -> ShipConfig:
    data = json.load(open(path))
    r = data['power_systems']['reactor']
    return ShipConfig(data['ship_id'], Reactor(r['id'], r['max_output_mw']))
```

## Примеры использования
```bash
jq '.hull.integrity' config/ship_config.json
```
```python
import json
cfg=json.load(open('config/ship_config.json'))
print(cfg['power_systems']['reactor']['status'])
```
```bash
python - <<'PY'
import json
cfg=json.load(open('config/ship_config.json'))
print(len(cfg['sensors']))
PY
```
```bash
sed -n '1,40p' config/ship_config.json
```
```python
import json
cfg=json.load(open('config/ship_config.json'))
print(cfg['computing']['qiki_core']['processing_power_tflops'])
```

## Тест-хуки/чек-лист
- Валидация всех обязательных секций.
- Проверка диапазонов числовых полей.
- Тест на отсутствие отдельных подсекций.
- Проверка уникальности идентификаторов устройств.
- Тест загрузки файла с неверным JSON.

## Вывод
- Файл описывает полный набор систем корабля.
- Структура подробная, но монолитная.
- Не везде указаны единицы измерения.
- Версионирование ограничено одной схемой.
- Разбиение по подсистемам улучшит поддержку.
- Валидация секций необходима для надёжности.
- Примеры показали возможность чтения стандартными средствами.
- Расширение структуры потребует документации.
- Файл подходит для симуляций и тестов.
- Поддержка обновлений требует строгого контроля.

# СПИСОК ФАЙЛОВ
- /home/sonra44/QIKI_DTMP/services/q_core_agent/config/ship_config.json
