СПИСОК ФАЙЛОВ
- services/q_core_agent/.qiki_bot.id

## Вход и цель
- [Факт] Файл пустой и скрытый, вероятно хранит идентификатор бота.
- [Гипотеза] Используется для уникальной метки экземпляра.

## Сбор контекста
- [Факт] Содержимое отсутствует, поэтому назначение выводится из имени.
- [Гипотеза] Значение заполняется при первом запуске `BotCore`.

## Локализация артефакта
- [Факт] `services/q_core_agent/.qiki_bot.id`.
- [Гипотеза] Расположение зависит от переменной `base_path`.

## Фактический разбор
- [Факт] Файл создан нулевой длины.
- [Гипотеза] Хранит строку формата `QIKI-YYYYMMDD-XXXXXXXX`.

## Роль в системе и связи
- [Факт] Связан с классом `BotCore` из модуля `core`.
- [Гипотеза] Используется для отслеживания состояния бота между запусками.

## Несоответствия и риски
- [Гипотеза] Пустой файл может вызвать ошибки чтения.
- [Гипотеза] Отсутствие валидации содержимого.

## Мини-патчи (safe-fix)
- [Патч] При запуске проверять, что файл содержит корректный ID.
- [Патч] Добавить резервную генерацию при повреждении файла.

## Рефактор-скетч
```python
from pathlib import Path
path = Path('services/q_core_agent/.qiki_bot.id')
if not path.read_text().strip():
    path.write_text('QIKI-00000000-00000000')
```

## Примеры использования
1. `cat services/q_core_agent/.qiki_bot.id`
2. `python3 - <<'PY'\nfrom pathlib import Path; print(Path('services/q_core_agent/.qiki_bot.id').exists())\nPY`
3. `rm services/q_core_agent/.qiki_bot.id` (для пересоздания)
4. `python3 services/q_core_agent/main.py --grpc` (создаёт ID)
5. `sed -n '1p' services/q_core_agent/.qiki_bot.id`

## Тест-хуки/чек-лист
- Проверить, что `BotCore` создаёт ID при отсутствии файла.
- Валидация формата ID.
- Обработка пустого файла.
- Переинициализация при удалении файла.
- Тестирование одновременного доступа.

## Вывод
1. Файл предназначен для хранения идентификатора бота.
2. В репозитории он пустой, требует инициализации.
3. Наличие файла критично для восстановления состояния.
4. Отсутствие валидации может привести к ошибкам.
5. Следует реализовать fallback ID.
6. Поддержка одновременной записи не рассмотрена.
7. ID должен быть человекочитаемым.
8. Файл скрыт для исключения случайных правок.
9. Тесты должны покрывать логику генерации.
10. Возможна миграция хранения в БД.

СПИСОК ФАЙЛОВ
- services/q_core_agent/.qiki_bot.id
