# СПИСОК ФАЙЛОВ
- scripts/run_qiki_demo.sh

## Вход и цель
Разбор демо-скрипта запуска Q-Sim и Q-Core Agent. Итог — обзор сценария и рекомендации.

## Сбор контекста
- [Факт] Скрипт запускает два Python-сервиса и пишет логи.
- [Факт] Использует `set -e` для остановки при ошибке.
- [Гипотеза] Предназначен для локального демонстрационного запуска.

## Локализация артефакта
- [Факт] Путь: `QIKI_DTMP/scripts/run_qiki_demo.sh`.
- [Факт] Требует файлы `services/q_sim_service/main.py` и `services/q_core_agent/main.py`.

## Фактический разбор
- [Факт] Определяет пути к сервисам и директорию логов.
- [Факт] Запускает процессы в фоне и сохраняет их PID.
- [Факт] Печатает инструкции по остановке процессов.
- [Гипотеза] Нет очистки процессов при ошибках.

## Роль в системе и связи
- [Факт] Обеспечивает быстрый старт демо-проекта.
- [Гипотеза] Может использоваться в обучении или презентациях.

## Несоответствия и риски
- [Гипотеза][Med] Отсутствует обработка `SIGINT`, возможны висячие процессы.
- [Гипотеза][Low] Не проверяет существование сервисных файлов.

## Мини-патчи (safe-fix)
- [Патч] Добавить trap для корректного завершения процессов.
- [Патч] Проверять наличие исполняемых файлов.

## Рефактор-скетч
```bash
trap 'kill $Q_SIM_PID $Q_CORE_PID' INT TERM
if [ ! -f "$Q_SIM_SERVICE_PATH" ]; then echo "missing"; exit 1; fi
```

## Примеры использования
1. ```bash
scripts/run_qiki_demo.sh
```
2. ```bash
LOG_DIR=/tmp/logs scripts/run_qiki_demo.sh
```
3. ```bash
bash scripts/run_qiki_demo.sh &
```
4. ```bash
kill $(cat .agent/pids)
```
5. ```bash
ps -p $Q_SIM_PID $Q_CORE_PID
```

## Тест-хуки/чек-лист
- `bash -n scripts/run_qiki_demo.sh` проходит без ошибок.
- Проверка корректности создания логов.
- Тест на остановку процессов по сигналу INT.

## Вывод
Скрипт упрощает демонстрацию системы, но нуждается в обработке сигналов и проверке зависимостей. Стоит добавить trap и проверки путей. Расширенное управление процессами можно реализовать позже.
