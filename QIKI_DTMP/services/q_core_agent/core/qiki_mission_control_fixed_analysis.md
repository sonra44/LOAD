СПИСОК ФАЙЛОВ
- services/q_core_agent/core/qiki_mission_control_fixed.py

## Вход и цель
- [Факт] Изучить `qiki_mission_control_fixed.py` — исправленный терминал управления.
- [Гипотеза] Используется для демонстраций с минимальными зависимостями.

## Сбор контекста
- [Факт] Зависит от `prompt_toolkit`, `ShipCore`, `ShipActuatorController`, `ShipLogicController`.
- [Факт] Обновляет параметры в отдельном потоке `_update_live_params`.
- [Гипотеза] Файл предназначен для стабильной работы на старых терминалах.

## Локализация артефакта
- [Факт] Путь: `services/q_core_agent/core/qiki_mission_control_fixed.py`.
- [Факт] Запуск через `python qiki_mission_control_fixed.py`.

## Фактический разбор
- [Факт] Класс `QIKIMissionControlFixed` строит интерфейс с живой телеметрией и вводом команд.
- [Факт] Команды: `thrust`, `autopilot`, `lang`, `emergency`, `status`.
- [Гипотеза] Прогресс миссии обновляется по массиву `mission_steps`.

## Роль в системе и связи
- [Факт] Служит самостоятельным CLI-дисплеем.
- [Гипотеза] Используется как fallback для основного терминала при проблемах с UI.

## Несоответствия и риски
- [Факт] Использование `random` для параметров может мешать воспроизводимости (Low).
- [Гипотеза] Потенциальные гонки между потоками интерфейса и обновления (Med).

## Мини-патчи (safe-fix)
- [Патч] Зафиксировать seed `random` для тестируемости.
- [Патч] Добавить блокировку при изменении `live_params` в потоке.

## Рефактор-скетч
```python
# [Патч] установка seed
import random
random.seed(42)
```

## Примеры использования
```bash
python qiki_mission_control_fixed.py           # [Факт]
```
```python
from core.qiki_mission_control_fixed import QIKIMissionControlFixed
QIKIMissionControlFixed().run()               # [Факт]
```
```bash
python qiki_mission_control_fixed.py --lang EN # [Гипотеза] будущий параметр
```
```bash
F1                                             # [Факт] переключение автопилота
```
```bash
F12                                            # [Факт] смена языка
```

## Тест-хуки/чек-лист
- [Факт] Юнит: проверка `_process_command` на разные команды.
- [Факт] Интеграция: запуск в тестовом терминале и ввод команд.
- [Гипотеза] Нагрузочный: длительный запуск с множеством событий.

## Вывод
- [Факт] Файл предлагает работоспособный терминал с живыми параметрами.
- [Факт] Потоки и случайные данные создают риски недетерминированности.
- [Патч] Ввести блокировки и фиксированный seed для стабильности.
- [Гипотеза] Можно вынести логику обновления в отдельный модуль.
- [Факт] Интерактивные команды покрывают основные сценарии управления.
- [Гипотеза] Следует добавить сохранение истории команд.
- [Факт] Уже существует переключение языка и автопилота.
- [Патч] Добавить опцию экспорта лога.
- [Гипотеза] Возможно подключение внешнего мониторинга.
- [Факт] Терминал пригоден как резервный инструмент.

СПИСОК ФАЙЛОВ
- services/q_core_agent/core/qiki_mission_control_fixed.py
