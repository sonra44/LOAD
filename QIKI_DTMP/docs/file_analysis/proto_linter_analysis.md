# СПИСОК ФАЙЛОВ
- proto_extensions/utils/proto_linter.py

## Вход и цель
[Факт] Разбор линтера `proto_linter.py`.
[Гипотеза] Цель — выявить ограничения и предложить улучшения.

## Сбор контекста
[Факт] Скрипт проверяет `.proto` файлы на использование `oneof` и `enum`.
[Гипотеза] Используется разработчиками для быстрого аудита схем.

## Локализация артефакта
[Факт] Путь: `proto_extensions/utils/proto_linter.py`.
[Гипотеза] Запускается вручную или в CI.

## Фактический разбор
- [Факт] Константы: `PROTO_DIR = Path("protos")`, `LINT_ERRORS`.
- [Факт] `check_oneof_usage` и `check_enum_typing` читают файл и добавляют предупреждения.
- [Факт] `lint_all` проходит по `*.proto` и выводит ошибки.
- [Гипотеза] Нет проверки возвратного кода для CI.

## Роль в системе и связи
[Факт] Предупреждает о нарушении правил моделирования протоколов.
[Гипотеза] Может быть интегрирован в сборку.

## Несоответствия и риски
- [Факт] Линтер ищет строки простым `in`, без парсинга (Med).
- [Гипотеза] Возможны ложные срабатывания (Med).

## Мини-патчи (safe-fix)
[Патч] Использовать парсер `protoc` или регулярные выражения для точности.

## Примеры использования
```bash
# 1. Запуск линтера
python proto_extensions/utils/proto_linter.py

# 2. Вызов функции lint_all из другого скрипта
python - <<'PY'
from proto_extensions.utils import proto_linter as pl
pl.lint_all()
PY

# 3. Проверка одного файла
python - <<'PY'
from proto_extensions.utils.proto_linter import check_oneof_usage
check_oneof_usage('protos/example.proto')
print(pl.LINT_ERRORS)
PY

# 4. Изменение директории
python - <<'PY'
from proto_extensions.utils import proto_linter as pl
pl.PROTO_DIR = Path('custom')
pl.lint_all()
PY

# 5. Скрипт в CI
echo "python proto_extensions/utils/proto_linter.py" >> .github/workflows/lint.yml
```

## Тест-хуки/чек-лист
- [Факт] Линтер должен находить отсутствие `oneof` при наличии `scalar_data`.
- [Гипотеза] Проверка на отсутствие `status_code` enum.
- [Факт] Возврат ненулевого кода при наличии ошибок.

## Вывод
1. [Факт] Линтер покрывает две базовые проверки.
2. [Гипотеза] Нужен более точный анализ синтаксиса.
3. [Патч] Добавить регулярные выражения или AST-парсер.
4. [Факт] Настраиваемая директория позволяет гибкость.
5. [Гипотеза] Интеграция в CI улучшит контроль схем.
6. [Факт] Примеры показывают способы вызова.
7. [Гипотеза] Возможны ложные срабатывания из-за простого поиска.
8. [Факт] Путь и зависимости задокументированы.
9. [Гипотеза] Низкая сложность — легко расширять.
10. [Патч] Возвращать код ошибки для автоматизации.

# СПИСОК ФАЙЛОВ
- proto_extensions/utils/proto_linter.py
